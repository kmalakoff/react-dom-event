{"version":3,"sources":["index.ts"],"sourcesContent":["import { useState, useEffect, useContext, createContext, createElement } from 'react';\nimport type { ReactNode } from 'react';\n\nexport type EventTypes = MouseEvent | TouchEvent | KeyboardEvent;\nexport type HandlerType = (event: EventTypes) => void;\n\nexport type EventContextType = {\n  subscribe: (handler: HandlerType) => void;\n};\n\nexport const EventContext = createContext<EventContextType | undefined>(\n  undefined,\n);\n\nexport type EventProviderProps = {\n  events?: string[];\n  children?: ReactNode;\n};\nexport function EventProvider({\n  events = ['click'],\n  children,\n}: EventProviderProps) {\n  const state = useState<HandlerType[]>([]);\n  const handlers = state[0]; // reduce transpiled array helpers\n\n  function onEvent(event: EventTypes) {\n    handlers.forEach((handler: HandlerType) => handler(event));\n  }\n  function subscribe(handler: HandlerType) {\n    handlers.push(handler);\n    return () => handlers.splice(handlers.indexOf(handler), 1);\n  }\n\n  useEffect(() => {\n    events.forEach((event) =>\n      window.document.addEventListener(event, onEvent, true),\n    );\n    return () =>\n      events.forEach((event) =>\n        window.document.removeEventListener(event, onEvent, true),\n      );\n  });\n\n      return createElement(EventContext.Provider, {\n        value: {\n            subscribe\n        }\n    }, children);\n}\n\nexport function useEvent(handler, dependencies) {\n  const context = useContext(EventContext);\n  if (!context) {\n    throw new Error(\n      'react-dom-event: subscribe not found on context. You might be missing the EventProvider or have multiple instances of react-dom-event',\n    );\n  }\n\n  useEffect(\n    () => context.subscribe(handler),\n    [context.subscribe, handler].concat(dependencies),\n  );\n}\n"],"names":["useState","useEffect","useContext","createContext","createElement","EventContext","undefined","EventProvider","events","children","state","handlers","onEvent","event","forEach","handler","subscribe","push","splice","indexOf","window","document","addEventListener","removeEventListener","Provider","value","useEvent","dependencies","context","Error","concat"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,UAAU,EAAEC,aAAa,EAAEC,aAAa,QAAQ,QAAQ;AAUtF,OAAO,MAAMC,eAAeF,cAC1BG,WACA;AAMF,OAAO,SAASC,cAAc,EAC5BC,SAAS;IAAC;CAAQ,EAClBC,QAAQ,EACW;IACnB,MAAMC,QAAQV,SAAwB,EAAE;IACxC,MAAMW,WAAWD,KAAK,CAAC,EAAE,EAAE,kCAAkC;IAE7D,SAASE,QAAQC,KAAiB;QAChCF,SAASG,OAAO,CAAC,CAACC,UAAyBA,QAAQF;IACrD;IACA,SAASG,UAAUD,OAAoB;QACrCJ,SAASM,IAAI,CAACF;QACd,OAAO,IAAMJ,SAASO,MAAM,CAACP,SAASQ,OAAO,CAACJ,UAAU;IAC1D;IAEAd,UAAU;QACRO,OAAOM,OAAO,CAAC,CAACD,QACdO,OAAOC,QAAQ,CAACC,gBAAgB,CAACT,OAAOD,SAAS;QAEnD,OAAO,IACLJ,OAAOM,OAAO,CAAC,CAACD,QACdO,OAAOC,QAAQ,CAACE,mBAAmB,CAACV,OAAOD,SAAS;IAE1D;IAEI,OAAOR,cAAcC,aAAamB,QAAQ,EAAE;QAC1CC,OAAO;YACHT;QACJ;IACJ,GAAGP;AACP;AAEA,OAAO,SAASiB,SAASX,OAAO,EAAEY,YAAY;IAC5C,MAAMC,UAAU1B,WAAWG;IAC3B,IAAI,CAACuB,SAAS;QACZ,MAAM,IAAIC,MACR;IAEJ;IAEA5B,UACE,IAAM2B,QAAQZ,SAAS,CAACD,UACxB;QAACa,QAAQZ,SAAS;QAAED;KAAQ,CAACe,MAAM,CAACH;AAExC"}