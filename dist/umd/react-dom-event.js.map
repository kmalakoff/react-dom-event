{"version":3,"file":"react-dom-event.js","sources":["../../src/index.ts"],"sourcesContent":["import { useState, useEffect, useContext, createContext, createElement } from 'react';\nimport type { ReactNode } from 'react';\n\nexport type EventTypes = MouseEvent | TouchEvent | KeyboardEvent;\nexport type HandlerType = (event: EventTypes) => void;\n\nexport type EventContextType = {\n  subscribe: (handler: HandlerType) => void;\n};\n\nexport const EventContext = createContext<EventContextType | undefined>(\n  undefined,\n);\n\nexport type EventProviderProps = {\n  events?: string[];\n  children?: ReactNode;\n};\nexport function EventProvider({\n  events = ['click'],\n  children,\n}: EventProviderProps) {\n  const state = useState<HandlerType[]>([]);\n  const handlers = state[0]; // reduce transpiled array helpers\n\n  function onEvent(event: EventTypes) {\n    handlers.forEach((handler: HandlerType) => handler(event));\n  }\n  function subscribe(handler: HandlerType) {\n    handlers.push(handler);\n    return () => handlers.splice(handlers.indexOf(handler), 1);\n  }\n\n  useEffect(() => {\n    events.forEach((event) =>\n      window.document.addEventListener(event, onEvent, true),\n    );\n    return () =>\n      events.forEach((event) =>\n        window.document.removeEventListener(event, onEvent, true),\n      );\n  });\n\n      return createElement(EventContext.Provider, {\n        value: {\n            subscribe\n        }\n    }, children);\n}\n\nexport function useEvent(handler, dependencies) {\n  const context = useContext(EventContext);\n  if (!context) {\n    throw new Error(\n      'react-dom-event: subscribe not found on context. You might be missing the EventProvider or have multiple instances of react-dom-event',\n    );\n  }\n\n  useEffect(\n    () => context.subscribe(handler),\n    [context.subscribe, handler].concat(dependencies),\n  );\n}\n"],"names":["EventContext","createContext","undefined","EventProvider","events","children","state","useState","handlers","onEvent","event","forEach","handler","subscribe","push","splice","indexOf","useEffect","window","document","addEventListener","removeEventListener","createElement","Provider","value","useEvent","dependencies","context","useContext","Error","concat"],"mappings":";;;;;;AAUO,MAAMA,YAAeC,GAAAA,mBAAAA,CAC1BC,SACA,EAAA;EAMK,SAASC,cAAc,KAGT,EAAA;EAHS,IAAA,IAAA,aAAA,GAAA,KAAA,CAC5BC,QAAAA,MAAS,GAAA,aAAA,KAAA,KAAA,CAAA,GAAA;EAAC,QAAA,OAAA;EAAQ,KAAA,GAAA,aAAA,EAClBC,WAF4B,KAE5BA,CAAAA,QAAAA,CAAAA;MAEA,IAAMC,KAAAA,GAAQC,eAAwB,EAAE,CAAA,CAAA;EACxC,IAAA,IAAMC,QAAWF,GAAAA,KAAK,CAAC,CAAA,CAAE;EAEzB,IAAA,SAASG,QAAQC,KAAiB,EAAA;UAChCF,QAASG,CAAAA,OAAO,CAAC,SAACC,OAAAA,EAAAA;qBAAyBA,OAAQF,CAAAA,KAAAA,CAAAA,CAAAA;;EACrD,KAAA;EACA,IAAA,SAASG,UAAUD,OAAoB,EAAA;EACrCJ,QAAAA,QAAAA,CAASM,IAAI,CAACF,OAAAA,CAAAA,CAAAA;UACd,OAAO,WAAA;EAAMJ,YAAAA,OAAAA,QAAAA,CAASO,MAAM,CAACP,QAASQ,CAAAA,OAAO,CAACJ,OAAU,CAAA,EAAA,CAAA,CAAA,CAAA;;EAC1D,KAAA;MAEAK,eAAU,CAAA,WAAA;UACRb,MAAOO,CAAAA,OAAO,CAAC,SAACD,KAAAA,EAAAA;EACdQ,YAAAA,OAAAA,MAAAA,CAAOC,QAAQ,CAACC,gBAAgB,CAACV,OAAOD,OAAS,EAAA,IAAA,CAAA,CAAA;;UAEnD,OAAO,WAAA;qBACLL,MAAOO,CAAAA,OAAO,CAAC,SAACD,KAAAA,EAAAA;EACdQ,gBAAAA,OAAAA,MAAAA,CAAOC,QAAQ,CAACE,mBAAmB,CAACX,OAAOD,OAAS,EAAA,IAAA,CAAA,CAAA;;;EAE1D,KAAA,CAAA,CAAA;MAEI,OAAOa,mBAAAA,CAActB,YAAauB,CAAAA,QAAQ,EAAE;UAC1CC,KAAO,EAAA;cACHX,SAAAA,EAAAA,SAAAA;EACJ,SAAA;OACDR,EAAAA,QAAAA,CAAAA,CAAAA;EACP,CAAA;EAEO,SAASoB,QAAAA,CAASb,OAAO,EAAEc,YAAY,EAAA;EAC5C,IAAA,IAAMC,UAAUC,gBAAW5B,CAAAA,YAAAA,CAAAA,CAAAA;EAC3B,IAAA,IAAI,CAAC2B,OAAS,EAAA;EACZ,QAAA,MAAM,IAAIE,KACR,CAAA,uIAAA,CAAA,CAAA;EAEJ,KAAA;MAEAZ,eACE,CAAA,WAAA;EAAMU,QAAAA,OAAAA,OAAAA,CAAQd,SAAS,CAACD,OAAAA,CAAAA,CAAAA;EACxB,KAAA,EAAA;EAACe,QAAAA,OAAAA,CAAQd,SAAS;EAAED,QAAAA,OAAAA;EAAQ,KAAA,CAACkB,MAAM,CAACJ,YAAAA,CAAAA,CAAAA,CAAAA;EAExC;;;;;;;;;;;;"}