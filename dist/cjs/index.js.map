{"version":3,"sources":["index.ts"],"sourcesContent":["import { createContext, createElement, useContext, useEffect, useState } from 'react';\nimport type { ReactNode } from 'react';\n\nexport type EventTypes = MouseEvent | TouchEvent | KeyboardEvent;\nexport type HandlerType = (event: EventTypes) => void;\n\nexport type EventContextType = {\n  subscribe: (handler: HandlerType) => void;\n};\n\nexport const EventContext = createContext<EventContextType | undefined>(undefined);\n\nexport type EventProviderProps = {\n  events?: string[];\n  children?: ReactNode;\n};\nexport function EventProvider({ events = ['click'], children }: EventProviderProps) {\n  const state = useState<HandlerType[]>([]);\n  const handlers = state[0]; // reduce transpiled array helpers\n\n  function onEvent(event: EventTypes) {\n    handlers.forEach((handler: HandlerType) => handler(event));\n  }\n  function subscribe(handler: HandlerType) {\n    handlers.push(handler);\n    return () => handlers.splice(handlers.indexOf(handler), 1);\n  }\n\n  useEffect(() => {\n    events.forEach((event) => window.document.addEventListener(event, onEvent, true));\n\n    return () => events.forEach((event) => window.document.removeEventListener(event, onEvent, true));\n  });\n\n  return createElement(\n    EventContext.Provider,\n    {\n      value: {\n        subscribe,\n      },\n    },\n    children,\n  );\n}\n\nexport function useEvent(handler, dependencies) {\n  const context = useContext(EventContext);\n  if (!context) {\n    throw new Error('react-dom-event: subscribe not found on context. You might be missing the EventProvider or have multiple instances of react-dom-event');\n  }\n\n  // biome-ignore lint/correctness/useExhaustiveDependencies: <explanation>\n  useEffect(() => context.subscribe(handler), [context.subscribe, handler].concat(dependencies));\n}\n"],"names":["EventContext","EventProvider","useEvent","createContext","undefined","events","children","state","useState","handlers","onEvent","event","forEach","handler","subscribe","push","splice","indexOf","useEffect","window","document","addEventListener","removeEventListener","createElement","Provider","value","dependencies","context","useContext","Error","concat"],"mappings":";;;;;;;;;;;IAUaA,YAAY;eAAZA;;IAMGC,aAAa;eAAbA;;IA6BAC,QAAQ;eAARA;;;qBA7C8D;AAUvE,IAAMF,eAAeG,IAAAA,oBAAa,EAA+BC;AAMjE,SAASH,cAAc,KAAoD;wBAApD,MAAEI,QAAAA,oCAAS;QAAC;KAAQ,kBAAEC,WAAtB,MAAsBA;IAClD,IAAMC,QAAQC,IAAAA,eAAQ,EAAgB,EAAE;IACxC,IAAMC,WAAWF,KAAK,CAAC,EAAE,EAAE,kCAAkC;IAE7D,SAASG,QAAQC,KAAiB;QAChCF,SAASG,OAAO,CAAC,SAACC;mBAAyBA,QAAQF;;IACrD;IACA,SAASG,UAAUD,OAAoB;QACrCJ,SAASM,IAAI,CAACF;QACd,OAAO;mBAAMJ,SAASO,MAAM,CAACP,SAASQ,OAAO,CAACJ,UAAU;;IAC1D;IAEAK,IAAAA,gBAAS,EAAC;QACRb,OAAOO,OAAO,CAAC,SAACD;mBAAUQ,OAAOC,QAAQ,CAACC,gBAAgB,CAACV,OAAOD,SAAS;;QAE3E,OAAO;mBAAML,OAAOO,OAAO,CAAC,SAACD;uBAAUQ,OAAOC,QAAQ,CAACE,mBAAmB,CAACX,OAAOD,SAAS;;;IAC7F;IAEA,OAAOa,IAAAA,oBAAa,EAClBvB,aAAawB,QAAQ,EACrB;QACEC,OAAO;YACLX,WAAAA;QACF;IACF,GACAR;AAEJ;AAEO,SAASJ,SAASW,OAAO,EAAEa,YAAY;IAC5C,IAAMC,UAAUC,IAAAA,iBAAU,EAAC5B;IAC3B,IAAI,CAAC2B,SAAS;QACZ,MAAM,IAAIE,MAAM;IAClB;IAEA,yEAAyE;IACzEX,IAAAA,gBAAS,EAAC;eAAMS,QAAQb,SAAS,CAACD;OAAU;QAACc,QAAQb,SAAS;QAAED;KAAQ,CAACiB,MAAM,CAACJ;AAClF"}